---
title: "BCS_RSA_Noun_Norming_Native"
output: pdf_document
#rmarkdown::github_document
#output:
  #html_document: default
  #pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning= FALSE, message = FALSE, echo = TRUE)
```

```{r data import, include=FALSE}
library(tidyverse)
theme_set(theme_bw())

source("../../../shared/analysis.R")
df = read.csv("../data/1_noun_norming_main-merged_cleaned.csv", header = TRUE)
df2 = read.csv("../data/1_noun_norming_fluent-merged_cleaned.csv", header = TRUE)

df <- rbind(df, df2)

subjectCleanUp <- df %>%
  select(workerid, schoolLanguage, firstLanguage, status) %>%
  unique()

#view(subjectCleanUp)


# There are "statuses" that are coded incorrectly. These incorrect codings are due to spelling errors and 
# listing two or more languages split up by / rather than spaces and commas

# Manually input them into the dataframe
df$status[df$workerid == 272] <- "heritage"
df$status[df$workerid == 248] <- "native"
df$status[df$workerid == 241] <- "heritage"
df$status[df$workerid == 274] <- "heritage"
df$status[df$workerid == 232] <- "native"
df$status[df$workerid == 394] <- "heritage"
df$status[df$workerid == 337] <- "native"
df$status[df$workerid == 402] <- "simk"
df$status[df$workerid == 152] <- "native"
df$status[df$workerid == 169] <- "native"
df$status[df$workerid == 262] <- "native"
df$status[df$workerid == 154] <- "native"
df$status[df$workerid == 423] <- "foreign"

# get rid of participants who answered with colors
# Get rid of participants who clearly used google translate (gvozdje instead of pegla and umreti instead of kocka)
df <- df %>%
  filter(workerid != 214 &  
           workerid != 333 &
           workerid != 346 &
           workerid != 261 &
           workerid != 357)

# get rid of SIMK and foreign speakers
df <- df %>%
  filter(status != "simk" & status != "foreign")

# Standardize spellings for ease
df$response = str_to_lower(str_replace_all(df$response, " ", ""))
df$response = str_to_lower(str_replace_all(df$response, "\n", ""))
df$response = str_replace_all(df$response, "č", "c")
df$response = str_replace_all(df$response,"ć", "c")
df$response = str_replace_all(df$response,"š", "s")
df$response = str_replace_all(df$response,"ž", "z")
df$response = str_replace_all(df$response,"đ", "dj")

# Change answers to account for spelling differences
# I only got through some responses before giving up on this method
df$response = str_replace_all(df$response, "avijon\\b", "avion")
df$response = str_replace_all(df$response, "putnickiavion\\b", "avion")
df$response = str_replace_all(df$response, "zelenizrakoplov\\b", "zrakoplov")

df$response = str_replace_all(df$response, "fotelj\\b", "fotelja")
df$response = str_replace_all(df$response, "fotelj\\b", "fatelja")
df$response = str_replace_all(df$response, "stolca\\b", "stolica")
df$response = str_replace_all(df$response, "stolcu\\b", "stolica")

df$response = str_replace_all(df$response, "balun\\b", "balon")
df$response = str_replace_all(df$response, "zutibalon\\b", "balon")

df$response = str_replace_all(df$response, "hansaplast\\b", "hanzaplast")
df$response = str_replace_all(df$response, "hanzaflast\\b", "hanzaplast")
df$response = str_replace_all(df$response, "hansaflast\\b", "hanzaplast")
df$response = str_replace_all(df$response, "hanzoplast\\b", "hanzaplast")
df$response = str_replace_all(df$response, "flajster\\b", "flaster")
df$response = str_replace_all(df$response, "plaster\\b", "flaster")
df$response = str_replace_all(df$response, "flastir\\b", "flaster")
df$response = str_replace_all(df$response, "bandaza\\b", "bandaz")
df$response = str_replace_all(df$response, "ljubicastiplaster\\b", "flaster")

df$response = str_replace_all(df$response, "korba\\b", "korpa")
df$response = str_replace_all(df$response, "korpica\\b", "korpa")

df$response = str_replace_all(df$response, "kosarica\\b", "kosara")
df$response = str_replace_all(df$response, "kosaricazakupovinu\\b", "kosara")
df$response = str_replace_all(df$response, "zelenakosarica\\b", "kosara")
df$response = str_replace_all(df$response, "pletenakosara\\b", "kosara")
df$response = str_replace_all(df$response, "slamnatakosara\\b", "kosara")

df$response = str_replace_all(df$response, "krever\\b", "krevet")
df$response = str_replace_all(df$response, "plavikrevet\\b", "krevet")
df$response = str_replace_all(df$response, "bracnikrevet\\b", "krevet")

df$response = str_replace_all(df$response, "kajs\\b", "kais")
df$response = str_replace_all(df$response, "kajis\\b", "kais")
df$response = str_replace_all(df$response, "kajis\\b", "kais")

df$response = str_replace_all(df$response, "klop\\b", "klupa")
df$response = str_replace_all(df$response, "klup\\b", "klupa")
df$response = str_replace_all(df$response, "klupica\\b", "klupa")
df$response = str_replace_all(df$response, "klopca\\b", "klupa") #this is the Slovenian word
df$response = str_replace_all(df$response, "drvenaklupa\\b", "klupa")
df$response = str_replace_all(df$response, "klupic\\b", "klupa")

df$response = str_replace_all(df$response, "bickil\\b", "bicikl")
df$response = str_replace_all(df$response, "plavibicikl\\b", "bicikl")
df$response = str_replace_all(df$response, "bicikel\\b", "bicikl")

df$response = str_replace_all(df$response, "loptica\\b", "lopta")
df$response = str_replace_all(df$response, "biljarskakugla\\b", "biljardkugla")

df$response = str_replace_all(df$response, "neznamrijeczato.nijesekoristiloujugoslavijitoliko\\b", "neznam")
df$response = str_replace_all(df$response, "neznamstajetacnoovo\\b", "neznam")
df$response = str_replace_all(df$response, "nezanm\\:\\)\\b", "neznam")
df$response = str_replace_all(df$response, "neznamstajeto\\b", "neznam")
df$response = str_replace_all(df$response, "mapu\\b", "mapa")
df$response = str_replace_all(df$response, "zutifolder\\b", "folder")

df$response = str_replace_all(df$response, "zaboravilasam.googlekazedvogledalimislimdasmotozvalidrukcije\\b", "neznam")
df$response = str_replace_all(df$response, "nemogusesjetiti\\b", "neznam")

df$response = str_replace_all(df$response, "bonbon\\b", "bombon")
df$response = str_replace_all(df$response, "bonbona\\b", "bombona")
df$response = str_replace_all(df$response, "bombone\\b", "bombona")
df$response = str_replace_all(df$response, "bmbon\\b", "bombon")
df$response = str_replace_all(df$response, "bonobn\\b", "bombon")
df$response = str_replace_all(df$response, "onbon\\b", "bombon")
df$response = str_replace_all(df$response, "ljubicastiomotzabonbon\\b", "bombon")
df$response = str_replace_all(df$response, "bon-bona\\b", "bombona")

df$response = str_replace_all(df$response, "kniga\\b", "knjiga")
df$response = str_replace_all(df$response, "crvenaknjiga\\b", "knjiga")
df$response = str_replace_all(df$response, "knjigu\\b", "knjiga")
df$response = str_replace_all(df$response, "biljeznica\\b", "beleznica")
df$response = str_replace_all(df$response, "kgniga\\b", "knjiga")
df$response = str_replace_all(df$response, "knjig\\b", "knjiga")

df$response = str_replace_all(df$response, "cizme\\b", "cizma")
df$response = str_replace_all(df$response, "cipele\\b", "cipela")
df$response = str_replace_all(df$response, "cisma\\b", "cizma")
df$response = str_replace_all(df$response, "cizmica\\b", "cizma")
df$response = str_replace_all(df$response, "gleznjace\\b", "gleznjaca")
df$response = str_replace_all(df$response, "cisme\\b", "cizma")
df$response = str_replace_all(df$response, "tsipale\\b", "cipela")
df$response = str_replace_all(df$response, "smedjecizme\\b", "cizma")

df$response = str_replace_all(df$response, "zdela\\b", "zdjela")
df$response = str_replace_all(df$response, "zdjelica\\b", "zdjela")
df$response = str_replace_all(df$response, "duboktanjir\\b", "tanjir")
df$response = str_replace_all(df$response, "dubokitanjir\\b", "tanjir")
df$response = str_replace_all(df$response, "tanjur\\b", "tanjir")
df$response = str_replace_all(df$response, "zdelja\\b", "zdjela")
df$response = str_replace_all(df$response, "dubljitanjir\\b", "tanjir")
df$response = str_replace_all(df$response, "posudja\\b", "posuda")
df$response = str_replace_all(df$response, "zdejla\\b", "zdjela")

df$response = str_replace_all(df$response, "crnakutija\\b", "kutija")
df$response = str_replace_all(df$response, "kutiju\\b", "kutija")
df$response = str_replace_all(df$response, "kartonskakutija\\b", "kutija")
df$response = str_replace_all(df$response, "kutia\\b", "kutija")
df$response = str_replace_all(df$response, "ljubicastakutija\\b", "kutija")

df$response = str_replace_all(df$response, "naruknica\\b", "narukvica")
df$response = str_replace_all(df$response, "ogrlice\\b", "ogrlica")
df$response = str_replace_all(df$response, "crvenarukvica\\b", "narukvica")
df$response = str_replace_all(df$response, "narukvica(brojanica)\\b", "narukvica")
df$response = str_replace_all(df$response, "narukvica\\?\\b", "narukvica")
df$response = str_replace_all(df$response, "bisernaogrlica\\b", "ogrlica")
df$response = str_replace_all(df$response, "narokvica\\b", "narukvica")

df$response = str_replace_all(df$response, "kantica\\b", "kanta")
df$response = str_replace_all(df$response, "crvenakanta\\b", "narukvica")
df$response = str_replace_all(df$response, "korpica\\b", "korpa")

df$response = str_replace_all(df$response, "leptitr\\b", "leptir")
df$response = str_replace_all(df$response, "ljeptir\\b", "leptir")
df$response = str_replace_all(df$response, "crvenileptir\\b", "leptir")
df$response = str_replace_all(df$response, "leptiri\\b", "leptir")

df$response = str_replace_all(df$response, "tarta\\b", "torta")
df$response = str_replace_all(df$response, "cokoladnikolac\\b", "kolac")
df$response = str_replace_all(df$response, "torte\\b", "torta")
df$response = str_replace_all(df$response, "tortsa\\b", "torta")


df$response = str_replace_all(df$response, "l+kalkulator\\b", "kalkulator")
df$response = str_replace_all(df$response, "calculator\\b", "kalkulator")
df$response = str_replace_all(df$response, "kalkulato\\b", "kalkulator")
df$response = str_replace_all(df$response, "racunalp\\b", "racunar")
df$response = str_replace_all(df$response, "dzepnoracunalo\\b", "racunalo")
df$response = str_replace_all(df$response, "zutikalkulator\\b", "kalkulator")

df$response = str_replace_all(df$response, "koledar\\b", "kalendar")
df$response = str_replace_all(df$response, "crnikalendar\\b", "kalendar")
df$response = str_replace_all(df$response, "kalender\\b", "kalendar")
df$response = str_replace_all(df$response, "koleendar\\b", "kalendar")
df$response = str_replace_all(df$response, "calendar\\b", "kalendar")
df$response = str_replace_all(df$response, "kolendar\\b", "kalendar")
df$response = str_replace_all(df$response, "kolodar\\b", "kalendar")
df$response = str_replace_all(df$response, "laendar\\b", "kalendar")


df$response = str_replace_all(df$response, "foto-aparat\\b", "fotoaparat")
df$response = str_replace_all(df$response, "analognifotoaparat\\b", "fotoaparat")
df$response = str_replace_all(df$response, "kamera\\?\\b", "kamera")
df$response = str_replace_all(df$response, "kumera\\b", "kamera")
df$response = str_replace_all(df$response, "camera\\b", "kamera")
df$response = str_replace_all(df$response, "narancastakamera\\b", "kamera")
df$response = str_replace_all(df$response, "camara\\b", "kamera")
df$response = str_replace_all(df$response, "insta/polaroidkamera\\b", "kamera")

df$response = str_replace_all(df$response, "svijeca\\b", "sveca")
df$response = str_replace_all(df$response, "svejca\\b", "sveca")
df$response = str_replace_all(df$response, "svica\\b", "sveca")
df$response = str_replace_all(df$response, "svijca\\b", "sveca")
df$response = str_replace_all(df$response, "svjiec\\b", "sveca")
df$response = str_replace_all(df$response, "svjeca\\b", "sveca")
df$response = str_replace_all(df$response, "sijeca\\b", "sveca")
df$response = str_replace_all(df$response, "svece\\b", "sveca")
df$response = str_replace_all(df$response, "zutasvijeca\\b", "sveca")

df$response = str_replace_all(df$response, "capu\\b", "kapa")
df$response = str_replace_all(df$response, "bijelakapa\\b", "kapa")
df$response = str_replace_all(df$response, "kapa\\?\\b", "kapa")
df$response = str_replace_all(df$response, "zutakapa\\b", "kapa")

df$response = str_replace_all(df$response, "stolivca\\b", "stolica")

df$response = str_replace_all(df$response, "budilnica\\b", "budilica")
df$response = str_replace_all(df$response, "satt\\b", "sat")
df$response = str_replace_all(df$response, "crvenabudilica\\b", "budilica")
df$response = str_replace_all(df$response, "alarmsat\\b", "alarm-sat")
df$response = str_replace_all(df$response, "sat/alarm\\b", "alarm-sat")
df$response = str_replace_all(df$response, "satalarm\\b", "alarm-sat")
df$response = str_replace_all(df$response, "alarma\\b", "alarm")
df$response = str_replace_all(df$response, "budilca\\b", "budilica")
df$response = str_replace_all(df$response, "budilnica\\b", "budilica")
df$response = str_replace_all(df$response, "budnica\\b", "budilica")
df$response = str_replace_all(df$response, "satbudilica\\b", "budilica")
df$response = str_replace_all(df$response, "say\\b", "sat")
df$response = str_replace_all(df$response, "stonisat\\b", "sat")
df$response = str_replace_all(df$response, "zutisat\\b", "sat")

df$response = str_replace_all(df$response, "vjesalica\\b", "vesalica")
df$response = str_replace_all(df$response, "hanger\\b", "ofinger")
df$response = str_replace_all(df$response, "ovinger\\b", "ofinger")
df$response = str_replace_all(df$response, "vesaljica\\b", "vesalica")
df$response = str_replace_all(df$response, "objesalnik\\b", "obesalnik")
df$response = str_replace_all(df$response, "besalicabesalica\\b", "vesalica")
df$response = str_replace_all(df$response, "aufinger\\b", "ofinger")
df$response = str_replace_all(df$response, "bijelavjesalica\\b", "vesalica")
df$response = str_replace_all(df$response, "visalica\\b", "vesalica")

df$response = str_replace_all(df$response, "vzglavnik\\b", "glavnik")
df$response = str_replace_all(df$response, "ceselj\\b", "cesalj")
df$response = str_replace_all(df$response, "casalj\\b", "cesalj")
df$response = str_replace_all(df$response, "cesaljzakosu\\b", "cesalj")
df$response = str_replace_all(df$response, "cesel\\b", "cesalj")
df$response = str_replace_all(df$response, "zuticesalj\\b", "cesalj")

df$response = str_replace_all(df$response, "krona\\b", "kruna")
df$response = str_replace_all(df$response, "krovna\\b", "kruna")
df$response = str_replace_all(df$response, "corona\\b", "kruna")
df$response = str_replace_all(df$response, "kryna\\b", "kruna")

df$response = str_replace_all(df$response, "jastuce\\b", "jastuk")
df$response = str_replace_all(df$response, "jastug\\b", "jastuk")
df$response = str_replace_all(df$response, "ukrasnijastuk\\b", "jastuk")
df$response = str_replace_all(df$response, "jastucic\\b", "jastuk")
df$response = str_replace_all(df$response, "jastukl\\b", "jastuk")
df$response = str_replace_all(df$response, "zutijastuk\\b", "jastuk")
df$response = str_replace_all(df$response, "zutjastuk\\b", "jastuk")

df$response = str_replace_all(df$response, "kockica\\b", "kocka")
df$response = str_replace_all(df$response, "kocke\\b", "kocka")
df$response = str_replace_all(df$response, "kockazaigranje\\b", "kocka")
df$response = str_replace_all(df$response, "kocak\\b", "kocka")
df$response = str_replace_all(df$response, "kocke\\b", "kocka")
df$response = str_replace_all(df$response, "kotcka\\b", "kocka")
df$response = str_replace_all(df$response, "kocika\\b", "kocka")
df$response = str_replace_all(df$response, "kocku\\b", "kocka")
df$response = str_replace_all(df$response, "ljubicastakocka\\b", "kocka")

df$response = str_replace_all(df$response, "bijelavrataidovratak\\b", "vrata")
df$response = str_replace_all(df$response, "brata\\b", "vrata")
df$response = str_replace_all(df$response, "vratu\\b", "vrata")
df$response = str_replace_all(df$response, "zutavrata\\b", "vrata")

df$response = str_replace_all(df$response, "plavahaljina\\b", "haljina")
df$response = str_replace_all(df$response, "odjeca\\b", "odeca")
df$response = str_replace_all(df$response, "haljinu\\b", "haljina")
df$response = str_replace_all(df$response, "hsljina\\b", "haljina")
df$response = str_replace_all(df$response, "belahaljina\\b", "haljina")
df$response = str_replace_all(df$response, "hsljina\\b", "haljina")
df$response = str_replace_all(df$response, "hajlina\\b", "haljina")
df$response = str_replace_all(df$response, "haljuna\\b", "haljina")

df$response = str_replace_all(df$response, "ormaric\\b", "ormar")
df$response = str_replace_all(df$response, "omar\\b", "ormar")
df$response = str_replace_all(df$response, "orman\\b", "ormar")
df$response = str_replace_all(df$response, "ormarica\\b", "ormar")
df$response = str_replace_all(df$response, "ormarsaladicama\\b", "ormar")
df$response = str_replace_all(df$response, "zelenakomoda\\b", "komoda")
df$response = str_replace_all(df$response, "zeleniormaric\\b", "ormar")
df$response = str_replace_all(df$response, "ljubicastakomoda\\b", "komoda")

df$response = str_replace_all(df$response, "buban\\b", "bubanj")
df$response = str_replace_all(df$response, "boban\\b", "bubanj")
df$response = str_replace_all(df$response, "bobni\\b", "bubanj")
df$response = str_replace_all(df$response, "bubabj\\b", "bubanj")
df$response = str_replace_all(df$response, "dubanj\\b", "bubanj")
df$response = str_replace_all(df$response, "malibubanj\\b", "bubanj")
df$response = str_replace_all(df$response, "bybanj\\b", "bubanj")
df$response = str_replace_all(df$response, "boben\\b", "bubanj")
df$response = str_replace_all(df$response, "boban\\b", "bubanj")

df$response = str_replace_all(df$response, "patkica\\b", "patka")
df$response = str_replace_all(df$response, "gumenapatkica\\b", "gumenapatka")
df$response = str_replace_all(df$response, "patkicazakupanje\\b", "patkazakupanje")
df$response = str_replace_all(df$response, "patke\\b", "patka")




df_split <- runAnalysis(df)


## Do people have a majority response over a 70% threshold?

# Input: string refering to object in df_split
# output: Return the percent of people responded the most common answer
getPercent <- function(objectName) {
  
  tib <- df_split[[objectName]]

  totalSum <- tib$count %>%
    sum()
  
  maxCount <- tib %>%
    group_by(cresponse) %>%
    summarise(n = sum(count))

  maxNum <- maxCount[which.max(maxCount$n),]$n
  return(maxNum/totalSum)
}

# Input: string refering to object in df_split
# output: Return the the most common esponse
getLabel <- function(objectName) {
  
  tib <- df_split[[objectName]]

  maxCount <- tib %>%
    group_by(cresponse) %>%
    summarise(n = sum(count))

  return(maxCount[which.max(maxCount$n),][[1]])
}


allNames <- names(df_split)

# create dataframe with most common responses 
# and percent of people that responded with them
df_percent <- data.frame(item = allNames,
                         label = unlist(lapply(allNames, getLabel)),
                         percent = unlist(lapply(allNames, getPercent)))

#append gender and color scheme to the df_percent
df_targets <- read.csv("../../../shared/final_targets.csv", header = TRUE)

df_targets <- df_targets %>%
  filter(Color == "blue" | Color == "green") %>%
  select(Item, Color.scheme, Gender)

colnames(df_targets) <- c("item", "colorScheme", "gender")

df_percent <- merge(df_targets, df_percent,by = c("item"))

# Function that takes in an object name and prints a plot of responses
# for that objects
makePlots <- function(objectName) {
  x <- plot_df_subset(df_split[[objectName]], objectName)
  x
}

```


```{r participant data, echo=FALSE}
# Plot participant data
participant_info <- df %>%
  select(workerid, status) %>%
  unique() %>%
  group_by(status) %>%
  summarize(count=n())

plot_demographics <- participant_info %>%
  ggplot(aes(x = status, y = count)) +
  geom_bar(stat="identity")

participant_dialectOne <- df %>%
  select(workerid, subject_information.dialectOne) %>%
  unique() %>%
  group_by(subject_information.dialectOne) %>%
  summarize(count=n())

plot_dialectOne <- participant_dialectOne %>%
  ggplot(aes(x = subject_information.dialectOne, y = count)) +
  geom_bar(stat="identity")

participant_dialectTwo <- df %>%
  select(workerid, subject_information.dialectTwo) %>%
  unique() %>%
  group_by(subject_information.dialectTwo) %>%
  summarize(count=n())

plot_dialectTwo <- participant_dialectTwo %>%
  ggplot(aes(x = subject_information.dialectTwo, y = count)) +
  geom_bar(stat="identity")

participant_dialectCountry <- df %>%
  select(workerid, country) %>%
  unique() %>%
  group_by(country) %>%
  summarize(count=n())

plot_dialectCountry<- participant_dialectCountry %>%
  ggplot(aes(x = country, y = count)) +
  geom_bar(stat="identity")
```

# Participant Demographics
## Language status

Foreign: first language and language spoken at school are not BCS  
Heritage: first language is BCS and language spoken at school is not BCS  
SIMK: Country of origin is Slovenia (SI) or Macedonia (MK)  
native: first language and language spoken at school are BCS  
  
For this iteration, I got rid of all SIMK and foreign speakers (their answers made the data a lot more messy)

```{r demographics, echo=FALSE}
plot_demographics
```

## Dialect Information
### Dialect Measure 1
Dialects are often split up based on the phonological change of the Common Slavic *jat* vowel (*ě), which changed to /i/ (Ikavian/Ikavica), /e/ (Ekavian/Ekavica), or /ije/ /je/ (Ijekavian/Ijekavica). Standard Croatian and Bosnian is based on Ijekavian, whereas standard Serbian is based on Ekavian. Serbians in Croatia, Bosnian Serbs, and Montenegrians mainly use Ijekavian. A geographic distribution is shown below. 

![alt text here](../../../shared/dialect_map_one.jpg)

yellow: ijekaciva  
blue: ekavica  
red: ikavica   
  
  
Our participants had the following distribution:  

```{r dialectOne, echo=FALSE}
plot_dialectOne
```

### Dialect Measure 2
Another common way of classifying the dialects is based on their most common wuestion word for "what": 
  
Shtokavian (Štokavski) = što/šta  
Chakavian (Čakavski) = Ča/ca  
Kajkavian (Kajkavski) = Kaj/key
  
Shtokavian is the standard for all of BCS and is spoken in Bosnia and Herzegovina, Croatia, Montenegro, and Serbia. 
Chakavian is spoken on the Croatian coast and Kajkavian is spoken in northern Croatia. Slovenians use the word "kaj" for the "what" question word, therefore I assume Slovenians would be classified as Kaikavian speakers based on my dialect survey (even if they don't produce the word "kaj" when speaking BCS). 
  
The map below gives a geographic distribution of the three dialects in Croatia. Bosnia and Herzegovina, Mongenegro, and Serbia would all be colored green based on this map. 
  
![alt text here](../../../shared/dialect_map_two.jpg)

Chakavian (blue) = Čakavski  
Kaikavian (purple) = Kajkavski  
Shtokavian (green) = Štokavski  

  
Our participants had the following dialect distribution:  
  
```{r dialectTwo, echo=FALSE}
plot_dialectTwo
```

### Country of participants
Participants answered the question: In which Ex-Jugoslav country did I live in/spent a lot of time in. This question aims to get a geographic distribution of participants. While we can classify speakers across ekavian/ikavian/ijekavian dialects, since this distiction represents a phonological one, it is unclear whether it will likewise reflect a difference in use of lexical items. Keep in mind that the answer to this question is distinct from what nationality participants identify as (for example there are Serbians, Croatians, and Bosnians who all live in Bosnia and Hercegovina). Based on my (limited) observations, I believe that country may be a better predictor of lexical items than national identity could be.  
    
BIH: Bosnia and Herzegovina  
HR: Croatia  
SRB: Serbia  
SI: Slovenia  
MK: Macedonia  
MNE: Montenegro  

```{r dialectCountry, echo=FALSE}
plot_dialectCountry
```


# Analysis of which words should be used

Please keep the following things in mind:
1. Some participants could not answer with 3 letter words. Therefore, if one of the top answers was a three letter word, take the rest of the answers with a grain of salt
2. Different spellings of the same word or a word with spelling errors are categorized as different answers

The following table is the % of people that answered the most common answer for each of the following words:
```{r percentCorrectTotal, echo=FALSE}
df_percent
```

The way we designed the study, we want a total of 48 targets per participant (+ 22 filler trials). That is:  
4 scenarios x 2 gender for target x 6 = 48 target trials    
+ 22 filler trials    
=  70 trials per pariticipant.  

There will be two stimuli sets based on color scheme:  
colorscheme 1 (cs1 = {blue, yellow, red, white};
cs2 = {green, purple, orange, black}  
For each trial, the stimuli images will be drawn randomly from within a single color scheme. Therefore we need a total of 96 items (each in 4 colors). Their distribution is as follows:

96 items:  
- 48 in color scheme 1  
  - 24 masculine  
  - 24 feminine  
- 48 in color scheme 2  
  - 24 masculine  
  - 24 feminine  
   
In order to see if we have enough stimuli based on our nameability norming, I group all the stimuli based on their color scheme and gender and then sort the nouns into the following groups:  
1. > 70% of responses are the same  
2. <70% of responses are the same, but if we account for spelling errors it seems that we will get >70% (I have yet to go through and do this manually)   
3. there are 2-3 majority words, the object is clearly identifiable, and all the words are the same gender  
4. there are 2-3 majority words, the object is clearly identifiable, but the words are of different genders  
5. there is no majority word and the object is clearly identifiable  
6. there is no majority word and the object is not clearly identifiable  


Overall the distribution of words with >70% responses agree on a single response are:
```{r percentOverSeventy, echo=FALSE}
df_percent %>%
  filter(percent >= 0.7) %>%
  summarise(n())
```

The number of responses that do not meet the 70% threshold are:
```{r percentUnderSeventy, echo=FALSE}
df_percent %>%
  filter(percent <= 0.7) %>%
  summarise(n())
```

We now split up by color scheme:

## Color Scheme 1 
The number of responses >= 70% threshold in color scheme 1 split up by gender:
```{r cs1, echo=FALSE}
df_percent %>%
  group_by(gender) %>%
  filter(colorScheme == 1 & percent >= 0.7) %>%
  summarise(n()) 
```


### Feminine

Here are all the items in color scheme one that are feminine
```{r cs1fem, echo=FALSE}
df_percent %>%
  filter(colorScheme == 1 & gender == "F") %>%
  arrange(percent)
```

As stated above, there are 16 feminine nouns that fall into category (1)

**Fall above the 70% threshold**
- door  
- crown  
- dress 
- candle  
- book  
- chair  
- pencil  
- iron  
- mask  
- guitar  
- fence  
- armchair  
- bucket  
- lamp  
- shirt  
- bracelet  

**would probably meet the 70% threshold with corrections**  

**different words same gender**   
- shoe: cipela, stikla  
- billiardball: lopta, kugla (often used in compounds)  
- mug: solja, salica, casa (cup)  
- stapler: heftalica, klamerica, spajalica  
  
**different words different gender**  
- magnifying glass: lupa, povecalo (! neuter)  
- napkin: salveta, maramica, ubrus  
  
**messy, but people get what the object is**   
- yarn: vuna, klupko (! neuter) — very messy  
- binder: a mess  
- notebook: a mess  
  
**people don't know what the object is**  
- ornament: a mess  
  
Along with the ones that meet the threshold: 
  
I would recommend including: shoe, mug, stapler    
which would lead to a total of 19 items.   
  
If we also want to include nouns of different genders: napkin  
which would lead to a total of 20 items.  
  
If we want to also include compound words: billiardball  
which would lead to a total of 21 items. 

  
### Masculine
Here are all the items in color scheme one that are masculine  
```{r cs1masc, echo=FALSE}
df_percent %>%
  filter(colorScheme == 1 & gender == "M") %>%
  arrange(percent)
```

As stated above, there are 9 masculine nouns that fall into category (1)  
  
**Fall above the 70% threshold**  
- butterfly  
- bed  
- balloon  
- phone  
- wallet  
- cushion  
- comb  
- key  
- ring  
  
**would probably meet the 70% threshold with corrections**  
- mouse: sometimes compound  
- flower: cvet versus cvijet  
- scarf    
- present: poklon, kutija (box), paket (packet) (poklon makes ub for 68% so its on the cusp)  
  
**different words same gender**  
- rug: tepih, tapet, cilim (occasional krpara, prostirka)  
- frame: okvir, ram  
- calculator: digitron, kalkulator  
- switch: prekidac, salter, uticnica (might end up adding up to 70% if it were cleaned up)  
- belt: kajs, remen, pojas  
  
**different words different gender**  
- cap: kapa, kacket, silterica  
- sword: mac, sablja, noz (might be different if it were added up)  
- coathanger: vesalica, ofinger  
- bike: bicikl, bicikla, biciklo (! neuter)  
- fryingpan: tiganj, tava  
- clock: sat, budilnik, budulica  
- ruler: lenjir, ravnalo (! neuter)  
  
**messy, but people get what the object is**  
- dustpan: lopata, djubrovnik, tons of others  
  
**people don't know what the object is**  
- table: klupa (bench), sto (table)  
  
Along with the ones that do meet the threshold,  
  
I would recommend including: mouse, flower, scarf, present, rug, frame, calculator, switch, belt  
which would lead to a total of 18 items.    
  
If we also want to include nouns of different genders: cap, sword, coathanger, fryingpan, clock  
which would lead to a total of 23 items.  
  
## Color Scheme 2
The number of responses >= 70% threshold in color scheme 2 split up by gender:    
```{r cs2, echo=FALSE}
df_percent %>%
  group_by(gender) %>%
  filter(colorScheme == 2 & percent >= 0.7) %>%
  summarise(n()) 
```


### Feminine

Here are all the items in color scheme two that are feminine  
```{r cs2fem, echo=FALSE}
df_percent %>%
  filter(colorScheme == 2 & gender == "F") %>%
  arrange(percent)
```

As stated above, there are 13 feminine nouns that fall into category (1)  
  
**Fall above the 70% threshold**  
- die  
- bench  
- fish  
- cake  
- box  
- tie  
- glove  
- sock  
- shell  
- ribbon  
- necklace  
- slipper  
- shovel  
  
**would probably meet the 70% threshold with corrections**
- vase: (occasional urna, cćup)  
  
**different words same gender**
- boot: cizma, cipela  
- spoon: kasika, zlica  
- fork: viljuska, vilica  
- bowl: zdela, cinija  
- basket: korpa, kosara  
- purse: tasna, torba  
- duck: patka, patkica, guska (occasional patak and lots of compounds)  
- whiste: zvizdaljka, pistaljka (some end in acč or uk)  
  
**different words different gender**
- bonbon: bonbon, bonbona  
- camera: kamera, aparat  
  

**messy, but people get what the object is**  
- ladle: and all the responses are feminine, there are just a lot of them  
- Dresser: komoda, ormar, and others  
  
**people don't know what the object is**  
  
Along with the ones that do meet the threshold,   
  
I would recommend including: vase, boot, spoon, fork, bowl, basket, purse, whistle
which would lead to a total of 21 items.  
  
If we also want to include nouns of different genders: bonbon, camera
which would lead to a total of 23 items.  
  
If we want to also include compound words: duck  
which would lead to a total of 24 items.  
  
Dresser might not be a bad contender, between 1/2 and 2/3 of people guessed either Ormar or Komoda  
  
### Masculine
Here are all the items in color scheme two that are masculine  
```{r cs2masc, echo=FALSE}
df_percent %>%
  filter(colorScheme == 2 & gender == "M") %>%
  arrange(percent)
```

As stated above, there are 14 masculine nouns that fall into category (1)    
   
**Fall above the 70% threshold**  
- calendar  
- umbrella  
- airplane  
- hammer  
- truck  
- piano  
- tent  
- drum  
- microcope  
- helicopter  
- shield  
- robot  
- luggage  
- bandaid  
  
**would probably meet the 70% threshold with corrections**  
- knife  
  
**different words same gender**  
- radio: radio/kasetefon (both masculine)  
- binoculars: dvogled, dalekozor  
- remote: daljinski, upravljac  
- lipstick: karmin, ruz, (occasional sminka)  
- screwdriver: srafciger, odvijac  
- lock: katanac, lokot (some brava)  
  
**different words different gender**  
- razor: brijac, zilet, britvica  
- sponge: sundjer, spunzva  
- plate: tanjir, tanjuric, tacna  
  
**messy, but people get what the object is**  
- rope: kanap, uže, konac, spaga  
  
**people don't know what the object is**  
  
I would recommend including: knife, radio, binoculars, remote, lipstick, screwdriver, lock  
which would lead to a total of 21 items.    
  
If we also want to include nouns of different genders: razor, sponge, plate  
which would lead to a total of 24 items.  
  
## Recommendations
It really comes down to the main question: Do we want to include objects with multiple labels of different genders, and if so will that be compatible with our analysis?  
   
And do we want to include compounds (billiard ball and rubber duck)?  
  
If we do decide to include objects with multiple labels of different genders, we get:  
- color scheme 1:  
  - Fem: 20/24  
  - Masc: 23/24  
- color scheme 2:  
  - Fem: 23/24  
  - Masc: 23/24  
  
  
# Participant Responses

Responses that participants gave to the question "What is this object called?" are given below. Each graph is faceted based on the color the object was presented in.   

```{r objects, echo=FALSE}
lapply(names(df_split), makePlots)
```

```{r output, include = FALSE}
#rmarkdown::render()
# library(rmarkdown)
# 
# render("analysis.Rmd", "pdf_document")

```




